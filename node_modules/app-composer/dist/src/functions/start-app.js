"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs");
const path = require("path");
const package_json_1 = require("../types/package-json");
const transform_to_compose_1 = require("./transform-to-compose");
const invoke_package_1 = require("./invoke-package");
function startApp(basePath = './') {
    const packageJson = package_json_1.PackageJson.read(basePath);
    if (!package_json_1.PackageJson.isComposable(packageJson)) {
        return;
    }
    const appComposer = packageJson['app-composer'];
    const perCompose = transform_to_compose_1.transformToCompose(packageJson, appComposer);
    perCompose.forEach((entryPoints, packageName) => {
        const ip = invoke_package_1.invokePackage(basePath, path.basename(packageName), entryPoints);
        fs.writeFileSync(ip.name, ip.localJs);
        // tslint:disable-next-line: no-eval
        // (() => { eval(js.js); })();
        require(ip.name);
    });
}
exports.startApp = startApp;
//# sourceMappingURL=start-app.js.map