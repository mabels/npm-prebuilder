{"version":3,"sources":["../../../src/app/actions/load-pattern-demo.js"],"names":["payload","dispatch","getState","getSrc","src","uri","type","id","headers","Accept","response","text","body","status","error","contents","force","demo","selectSrc"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAEgBA,OAAD,IACN,CAAOC,QAAP,EAAiBC,QAAjB;AAAA;AACCC,QADD,GACUC,IAAIF,QAAJ,CADV;AAECG,KAFD,GAEOF,QAFP;;AAIL,MAAI,CAACE,GAAL,EAAU;AACR;AACD;;AAEDJ,WAAS;AACPK,UAAM,yBADC;AAEPN,aAAS;AAAEO,UAAIF;AAAN;AAFF,GAAT;AAKiB,SAAM,8BAAMA,GAAN,EAAW;AAChCG,aAAS;AAAEC,cAAQ;AAAV;AADuB,GAAX,CAAN;AAAXC,YAAW;;AAIjB;AACA,QAAIL,QAAQF,QAAZ,EAAsB;AACpB;AACD;;AAEY,WAAMO,SAASC,IAAT,EAAN;AAAPC,UAAO;;AAEb;AACA,UAAIP,QAAQF,QAAZ,EAAsB;AACpB;AACD;;AAED,UAAIO,SAASG,MAAT,IAAmB,GAAvB,EAA4B;AAC1B,uBAAOZ,SAAS;AACdK,gBAAM,yBADQ;AAEdN,mBAAS;AAAEO,gBAAIF,GAAN;AAAWS,mBAAOF;AAAlB;AAFK,SAAT,CAAP;AAID;;AAEDX,eAAS;AACPK,cAAM,2BADC;AAEPN,iBAAS;AAAEO,cAAIF,GAAN;AAAWU,oBAAUH,IAArB;AAA2BI,iBAAOhB,QAAQgB;AAA1C;AAFF,OAAT;AAda;AAAA;AATI;AAbZ,qB;;;;AA2CT,SAASZ,GAAT,CAAaF,QAAb,EAAuB;AACrB,SAAO,MAAMe,KAAKC,SAAL,CAAehB,UAAf,CAAb;AACD","file":"load-pattern-demo.js","sourcesContent":["import fetch from \"isomorphic-fetch\";\nimport * as demo from \"../selectors/demo\";\n\nexport default (payload) => {\n  return async (dispatch, getState) => {\n    const getSrc = src(getState);\n    const uri = getSrc();\n\n    if (!uri) {\n      return;\n    }\n\n    dispatch({\n      type: \"LOAD_PATTERN_DEMO_START\",\n      payload: { id: uri }\n    });\n\n    const response = await fetch(uri, {\n      headers: { Accept: \"text/html\" }\n    });\n\n    // Bail if the src changed in the meantime\n    if (uri !== getSrc()) {\n      return;\n    }\n\n    const body = await response.text();\n\n    // Bail if the src changed in the meantime\n    if (uri !== getSrc()) {\n      return;\n    }\n\n    if (response.status >= 400) {\n      return dispatch({\n        type: \"LOAD_PATTERN_DEMO_ERROR\",\n        payload: { id: uri, error: body }\n      });\n    }\n\n    dispatch({\n      type: \"LOAD_PATTERN_DEMO_SUCCESS\",\n      payload: { id: uri, contents: body, force: payload.force }\n    });\n  };\n};\n\nfunction src(getState) {\n  return () => demo.selectSrc(getState());\n}\n"]}