{"version":3,"sources":["../../../src/app/actions/promise-thunk-action.js"],"names":["ident","i","asyncIdent","createPromiseThunkAction","name","rawCreator","creator","fn","payload","delayedAction","successAction","startAction","throwsAction","dispatch","getState","delayedTimer","global","setTimeout","error","console","clearTimeout","Promise","resolve","result","__name","handlePromiseThunkAction","rawName","handler","options","dependencies","reducer","start","delayed","success","throws"],"mappings":";;;;;;;;AAAA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,MAAMA,QAAQC,KAAKA,CAAnB;;AACA,MAAMC,aAAmBD,CAAN;AAAA,iBAAWA,CAAX;AAAA,qBAAnB;;AAEO,SAASE,wBAAT,CAAkCC,IAAlC,EAAwCC,UAAxC,EAAoD;AACzD,QAAMC,UAAUD,cAAcH,UAA9B;;AAEA,QAAMK,KAAKC,WAAW;AACpB,UAAMC,gBAAgB,gCAAc,GAAEL,IAAK,UAArB,CAAtB;AACA,UAAMM,gBAAgB,gCAAc,GAAEN,IAAK,UAArB,CAAtB;AACA,UAAMO,cAAc,gCAAc,GAAEP,IAAK,QAArB,CAApB;AACA,UAAMQ,eAAe,gCAAc,GAAER,IAAK,SAArB,CAArB;AAEA,WAAO,CAAOS,QAAP,EAAiBC,QAAjB;AAAA;AACLD,eAASF,YAAYH,OAAZ,EAAqBR,KAArB,EAA4Bc,QAA5B,CAAT;AACMC,kBAFD,GAEgBC,OAAOC,UAAP,CAAkB,MAAM;AAC3CJ,iBAASJ,cAAcD,OAAd,EAAuBR,KAAvB,EAA8Bc,QAA9B,CAAT;AACD,OAFoB,EAElB,IAFkB,CAFhB;;AAAA;AAAA;AAAA;;AAAA,mCAYII,KAZJ,EAYW;AACdC,gBAAQD,KAAR,CAAcA,KAAd;AACAF,eAAOI,YAAP,CAAoBL,YAApB;AACAF,iBAASD,aAAaM,KAAb,CAAT;AACA,uBAAOA,KAAP;AACD,OAjBI;;AAKL,UAAI;AACa,eAAMG,QAAQC,OAAR,CACnBhB,QAAQE,OAAR,EAAiBK,QAAjB,EAA2BC,QAA3B,CADmB,CAAN;AAATS,gBAAS;AAGfP,iBAAOI,YAAP,CAAoBL,YAApB;AACAF,mBAASH,cAAca,MAAd,CAAT;AACA,yBAAOA,MAAP;AALe;AAMhB,OAPD,CAOE,OAAOL,KAAP,EAAc;AAAA,qBAAPA,KAAO;AAKf;AAjBI,uBAAP;AAmBD,GAzBD;;AA0BAX,KAAGiB,MAAH,GAAYpB,IAAZ;AACA,SAAOG,EAAP;AACD;;AAEM,SAASkB,wBAAT,CAAkCC,OAAlC,EAA2CC,OAA3C,EAAoDC,UAAU,EAA9D,EAAkE;AACvE,QAAMxB,OAAOsB,QAAQF,MAAR,IAAkBE,OAA/B;AACAE,UAAQC,YAAR,GAAuBD,QAAQC,YAAR,IAAwB,EAA/C;AACA,QAAMC,UAAU,qCACd;AACE,KAAE,GAAE1B,IAAK,QAAT,GAAmBuB,QAAQI,KAAR,IAAiB/B,KADtC;AAEE,KAAE,GAAEI,IAAK,UAAT,GAAqBuB,QAAQK,OAAR,IAAmBhC,KAF1C;AAGE,KAAE,GAAEI,IAAK,UAAT,GAAqBuB,QAAQM,OAAR,IAAmBjC,KAH1C;AAIE,KAAE,GAAEI,IAAK,SAAT,GAAoBuB,QAAQO,MAAR,IAAkBlC;AAJxC,GADc,EAOd4B,OAPc,CAAhB;AASA,SAAOE,OAAP;AACD","file":"promise-thunk-action.js","sourcesContent":["import { createAction } from \"redux-actions\";\nimport handleDependentActions from \"./handle-dependent-actions\";\n\nconst ident = i => i;\nconst asyncIdent = async i => i;\n\nexport function createPromiseThunkAction(name, rawCreator) {\n  const creator = rawCreator || asyncIdent;\n\n  const fn = payload => {\n    const delayedAction = createAction(`${name}_DELAYED`);\n    const successAction = createAction(`${name}_SUCCESS`);\n    const startAction = createAction(`${name}_START`);\n    const throwsAction = createAction(`${name}_THROWS`);\n\n    return async (dispatch, getState) => {\n      dispatch(startAction(payload, ident, getState));\n      const delayedTimer = global.setTimeout(() => {\n        dispatch(delayedAction(payload, ident, getState));\n      }, 1000);\n      try {\n        const result = await Promise.resolve(\n          creator(payload, dispatch, getState)\n        );\n        global.clearTimeout(delayedTimer);\n        dispatch(successAction(result));\n        return result;\n      } catch (error) {\n        console.error(error);\n        global.clearTimeout(delayedTimer);\n        dispatch(throwsAction(error));\n        return error;\n      }\n    };\n  };\n  fn.__name = name;\n  return fn;\n}\n\nexport function handlePromiseThunkAction(rawName, handler, options = {}) {\n  const name = rawName.__name || rawName;\n  options.dependencies = options.dependencies || [];\n  const reducer = handleDependentActions(\n    {\n      [`${name}_START`]: handler.start || ident,\n      [`${name}_DELAYED`]: handler.delayed || ident,\n      [`${name}_SUCCESS`]: handler.success || ident,\n      [`${name}_THROWS`]: handler.throws || ident\n    },\n    options\n  );\n  return reducer;\n}\n"]}