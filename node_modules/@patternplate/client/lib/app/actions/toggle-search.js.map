{"version":3,"sources":["../../../src/app/actions/toggle-search.js"],"names":["toggleSearch","type","payload","dispatch","getState","state","sync","focus","searchEnabled","next","persist","value","query","key","property","global","setTimeout","el","document","querySelector","activeElement","range","length","setSelectionRange"],"mappings":";;;;;;;AAAA;;eAEeA,Y;;AAER,MAAMC,OAAO,uBAAb;;;AAEP,SAASD,YAAT,CAAsBE,UAAU,EAAhC,EAAoC;AAClC,SAAO,CAACC,QAAD,EAAWC,QAAX,KAAwB;AAC7B,UAAMC,QAAQD,UAAd;;AAEA,QAAIF,QAAQI,IAAZ,EAAkB;AAChBC,YAAMF,MAAMG,aAAZ;AACA;AACD;;AAED,UAAMC,OAAO,WAAWP,OAAX,GAAqBA,QAAQK,KAA7B,GAAqC,CAACF,MAAMG,aAAzD;;AAEA,QAAI,CAACC,IAAL,EAAW;AACTN,eAAS,cAAO;AAAEO,iBAAS,IAAX;AAAiBC,eAAOA;AAAxB,OAAP,CAAT;AACD;;AAEDR,aACE,qBAAc;AAAES,aAAO;AAAE,0BAAkBH,IAApB;AAA0B,0BAAkB;AAA5C;AAAT,KAAd,CADF;AAGD,GAjBD;AAkBD;;AAEDT,aAAaC,IAAb,GAAoBA,IAApB;AACAD,aAAaa,GAAb,GAAmB,gBAAnB;AACAb,aAAac,QAAb,GAAwB,eAAxB;;AAEA,SAASP,KAAT,CAAeE,IAAf,EAAqB;AACnB,MAAI,CAACA,IAAL,EAAW;AACT;AACD;;AAED,MAAI,EAAE,cAAcM,MAAhB,CAAJ,EAA6B;AAC3B;AACD;;AAEDC,aAAW,MAAM;AACf,UAAMC,KAAKF,OAAOG,QAAP,CAAgBC,aAAhB,CAA8B,oBAA9B,CAAX;;AAEA,QAAI,CAACF,EAAL,EAAS;AACP;AACD;;AAED,QAAIF,OAAOG,QAAP,CAAgBE,aAAhB,KAAkCH,EAAtC,EAA0C;AACxCA,SAAGV,KAAH;AACD;;AAED,UAAMc,QAAQJ,GAAGN,KAAH,CAASW,MAAvB;AACAL,OAAGM,iBAAH,CAAqBF,KAArB,EAA4BA,KAA5B;AACD,GAbD,EAaG,GAbH;AAcD;;AAED,SAASV,KAAT,GAAiB;AACf,MAAI,EAAE,cAAcI,MAAhB,CAAJ,EAA6B;AAC3B;AACD;;AAED,QAAME,KAAKF,OAAOG,QAAP,CAAgBC,aAAhB,CAA8B,oBAA9B,CAAX;;AAEA,MAAI,CAACF,EAAL,EAAS;AACP;AACD;;AAED,SAAOA,GAAGN,KAAV;AACD","file":"toggle-search.js","sourcesContent":["import { patchLocation, search } from \"./\";\n\nexport default toggleSearch;\n\nexport const type = \"TOGGLE_SEARCH_ENABLED\";\n\nfunction toggleSearch(payload = {}) {\n  return (dispatch, getState) => {\n    const state = getState();\n\n    if (payload.sync) {\n      focus(state.searchEnabled);\n      return;\n    }\n\n    const next = \"focus\" in payload ? payload.focus : !state.searchEnabled;\n\n    if (!next) {\n      dispatch(search({ persist: true, value: value() }));\n    }\n\n    dispatch(\n      patchLocation({ query: { \"search-enabled\": next, \"search-preview\": 0 } })\n    );\n  };\n}\n\ntoggleSearch.type = type;\ntoggleSearch.key = \"search-enabled\";\ntoggleSearch.property = \"searchEnabled\";\n\nfunction focus(next) {\n  if (!next) {\n    return;\n  }\n\n  if (!(\"document\" in global)) {\n    return;\n  }\n\n  setTimeout(() => {\n    const el = global.document.querySelector(\"input[data-search]\");\n\n    if (!el) {\n      return;\n    }\n\n    if (global.document.activeElement !== el) {\n      el.focus();\n    }\n\n    const range = el.value.length;\n    el.setSelectionRange(range, range);\n  }, 100);\n}\n\nfunction value() {\n  if (!(\"document\" in global)) {\n    return;\n  }\n\n  const el = global.document.querySelector(\"input[data-search]\");\n\n  if (!el) {\n    return;\n  }\n\n  return el.value;\n}\n"]}