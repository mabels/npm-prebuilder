{"version":3,"sources":["../../../src/app/layouts/index.js"],"names":["DETONATOR","process","env","WEBPACK","require","String","readFileSync","resolve","__dirname","layout","props","layoutSheet","collectStyles","layoutCSS","getStyleElement","Layout","attributes","toComponent","scripts","Array","isArray","title","meta","link","__html","css","base","icons","html","data","map","src","StyledDocument","StyledBody","body","IconRegistry","display","children","Content","content","StyledContent","div","State","value","encodeURIComponent","stringify","StyledState","textarea"],"mappings":";;;;;;;AACA;;AACA;;AACA;;AACA;;;;;;AAEA,MAAMA,YAAYC,QAAQC,GAAR,CAAYC,OAAZ,GACdC,QAAQ,wBAAR,CADc,GAEdC,OAAOD,QAAQ,IAAR,EAAcE,YAAd,CAA2BF,QAAQ,MAAR,EAAgBG,OAAhB,CAAwBC,SAAxB,EAAmC,cAAnC,CAA3B,CAAP,CAFJ;eAIeC,M;;;AAEf,SAASA,MAAT,CAAgBC,KAAhB,EAAuB;AACrB,QAAMC,cAAc,kCAApB;AACAA,cAAYC,aAAZ,CAA0B,kCAAO,6BAAC,MAAD,OAAP,CAA1B;AACA,QAAMC,YAAYF,YAAYG,eAAZ,EAAlB;AAEA,SAAQ,kBAAiB,kCACvB,6BAAC,MAAD,eAAYJ,KAAZ;AAAmB,eAAWG;AAA9B,KADuB,CAEvB,EAFF;AAGD;;AAED,SAASE,MAAT,CAAgBL,KAAhB,EAAuB;AACrB,QAAMM,aAAaN,MAAMM,UAAN,GAAmBN,MAAMM,UAAN,CAAiBC,WAAjB,EAAnB,GAAoD,EAAvE;AACA,QAAMC,UAAUC,MAAMC,OAAN,CAAcV,MAAMQ,OAApB,IAA+BR,MAAMQ,OAArC,GAA+C,EAA/D;AAEA,SACE,6BAAC,cAAD,EAAoBF,UAApB,EACE,2CACGN,MAAMW,KAAN,IAAeX,MAAMW,KAAN,CAAYJ,WAAZ,EADlB,EAEGP,MAAMY,IAAN,IAAcZ,MAAMY,IAAN,CAAWL,WAAX,EAFjB,EAGGP,MAAMa,IAAN,IAAcb,MAAMa,IAAN,CAAWN,WAAX,EAHjB,EAIE;AAAQ,6BAAyB;AAACO,cAAQxB;AAAT;AAAjC,IAJF,EAKGU,MAAMG,SALT,EAMGH,MAAMe,GANT,CADF,EASE,6BAAC,UAAD;AAAY,iBAAWf,MAAMgB;AAA7B,KACE,6BAAC,YAAD,QAAehB,MAAMiB,KAArB,CADF,EAEE,6BAAC,OAAD;AAAS,2BAAoB,cAA7B;AAA4C,aAASjB,MAAMkB;AAA3D,IAFF,EAGE,6BAAC,KAAD;AAAO,8BAAuB,cAA9B;AAA6C,UAAMlB,MAAMmB;AAAzD,IAHF,EAIGX,QAAQY,GAAR,CAAYC,OAAO;AAAQ,SAAKA,GAAb;AAAkB,SAAKA;AAAvB,IAAnB,CAJH,CATF,CADF;AAkBD;;AAED,MAAMC,iBAAiB,mBAAOJ,IAAxB;AAAA;AAAA,oCAAN;;AAKA,MAAMK,aAAa,mBAAOC,IAApB;AAAA;AAAA,6BAAN;;AAKA,SAASC,YAAT,CAAsBzB,KAAtB,EAA6B;AAC3B,SACE;AAAK,8BAAL;AAAwB,WAAO;AAAE0B,eAAS;AAAX;AAA/B,KACG1B,MAAM2B,QADT,CADF;AAKD;;AAED,SAASC,OAAT,CAAiB5B,KAAjB,EAAwB;AACtB,SACE,6BAAC,aAAD;AACE,2BAAqBA,MAAM,qBAAN,CADvB;AAEE,6BAAyB;AAAEc,cAAQd,MAAM6B;AAAhB;AAF3B,IADF;AAMD;;AAED,MAAMC,gBAAgB,mBAAOC,GAAvB;AAAA;AAAA,oBAAN;;AAIA,SAASC,KAAT,CAAehC,KAAf,EAAsB;AACpB,QAAMiC,QAAQC,mBAAmB,eAAMC,SAAN,CAAgBnC,MAAMmB,IAAtB,CAAnB,CAAd;AACA,SACE,6BAAC,WAAD;AACE,8BAAwBnB,MAAM,wBAAN,CAD1B;AAEE,WAAOiC,KAFT;AAGE;AAHF,IADF;AAOD;;AAED,MAAMG,cAAc,mBAAOC,QAArB;AAAA;AAAA,qBAAN","file":"index.js","sourcesContent":["/* eslint-disable react/no-danger */\nimport ARSON from \"arson\";\nimport React from \"react\";\nimport { renderToStaticMarkup as render } from \"react-dom/server\";\nimport { styled, ServerStyleSheet } from \"@patternplate/components\";\n\nconst DETONATOR = process.env.WEBPACK\n  ? require(\"raw-loader!./detonator\")\n  : String(require(\"fs\").readFileSync(require(\"path\").resolve(__dirname, \"detonator.js\")));\n\nexport default layout;\n\nfunction layout(props) {\n  const layoutSheet = new ServerStyleSheet();\n  layoutSheet.collectStyles(render(<Layout />));\n  const layoutCSS = layoutSheet.getStyleElement();\n\n  return `<!doctype html>${render(\n    <Layout {...props} layoutCSS={layoutCSS} />\n  )}`;\n}\n\nfunction Layout(props) {\n  const attributes = props.attributes ? props.attributes.toComponent() : {};\n  const scripts = Array.isArray(props.scripts) ? props.scripts : [];\n\n  return (\n    <StyledDocument {...attributes}>\n      <head>\n        {props.title && props.title.toComponent()}\n        {props.meta && props.meta.toComponent()}\n        {props.link && props.link.toComponent()}\n        <script dangerouslySetInnerHTML={{__html: DETONATOR}}/>\n        {props.layoutCSS}\n        {props.css}\n      </head>\n      <StyledBody data-base={props.base}>\n        <IconRegistry>{props.icons}</IconRegistry>\n        <Content data-application-el=\"patternplate\" content={props.html} />\n        <State data-application-state=\"patternplate\" data={props.data} />\n        {scripts.map(src => <script key={src} src={src} />)}\n      </StyledBody>\n    </StyledDocument>\n  );\n}\n\nconst StyledDocument = styled.html`\n  height: 100%;\n  overflow: hidden;\n`;\n\nconst StyledBody = styled.body`\n  margin: 0;\n  height: 100%;\n`;\n\nfunction IconRegistry(props) {\n  return (\n    <div data-icon-registry style={{ display: \"none\" }}>\n      {props.children}\n    </div>\n  );\n}\n\nfunction Content(props) {\n  return (\n    <StyledContent\n      data-application-el={props[\"data-application-el\"]}\n      dangerouslySetInnerHTML={{ __html: props.content }}\n    />\n  );\n}\n\nconst StyledContent = styled.div`\n  height: 100%;\n`;\n\nfunction State(props) {\n  const value = encodeURIComponent(ARSON.stringify(props.data));\n  return (\n    <StyledState\n      data-application-state={props[\"data-application-state\"]}\n      value={value}\n      readOnly\n    />\n  );\n}\n\nconst StyledState = styled.textarea`\n  display: none;\n`;\n"]}