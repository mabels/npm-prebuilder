{"version":3,"sources":["../../../src/app/layouts/detonator.js"],"names":["query","parseQueryString","window","location","search","SUPPORTED","supported","addEventListener","el","document","querySelector","style","display","observer","MutationObserver","mutations","i","length","j","addedNodes","node","nodeType","matches","setAttribute","name","getAttribute","observe","documentElement","childList","subtree","e","body","trigger","inside","target","preventDefault","q","JSON","parse","stringify","stringifyQuery","link","href","charAt","lq","pathname","merge","selector","msMatchesSelector","o","p","r","attrname","eval","err","map","Object","keys","key","join","slice","split","pair","reduce","acc","entry","parentNode"],"mappings":"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","file":"detonator.js","sourcesContent":["/**\n * This script is embedded into the <head>\n * of all patternplate documents. It provides\n * toggle functionality that should run before\n * the main React application mounts on the\n * Server Side Rendered HTML document.\n *\n *\n */\nvar query = parseQueryString(window.location.search);\nvar SUPPORTED = supported();\n\nwindow.addEventListener(\"error\", function () {\n  if (SUPPORTED && query[\"js-warning-enabled\"] !== \"false\") {\n    var el = document.querySelector(\"[data-js-warning]\");\n    if (el) {\n      el.style.display = \"block\";\n    }\n  }\n});\n\nvar observer = new MutationObserver(function(mutations) {\n  for (var i=0; i < mutations.length; i++){\n    for (var j=0; j < mutations[i].addedNodes.length; j++){\n      var node = mutations[i].addedNodes[j];\n\n      if (node.nodeType !== 1) {\n        continue;\n      }\n\n      if (matches(node, \"[data-toggle-name]\")) {\n        // Force open all toggles if browser is unsupported\n        if (!SUPPORTED) {\n          node.setAttribute(\"data-toggle-enabled\", true);\n        }\n\n        var name = node.getAttribute(\"data-toggle-name\");\n        node.setAttribute(\"data-toggle-enabled\", query[name + \"-enabled\"]);\n      }\n\n      if (matches(node, \"[data-browser-warning]\")) {\n        node.style.display = !SUPPORTED && query[\"browser-warning-enabled\"] !== \"false\" ? \"block\" : \"none\";\n      }\n    }\n  }\n});\n\nobserver.observe(document.documentElement, {\n  childList: true,\n  subtree: true\n});\n\ndocument.documentElement.addEventListener(\"click\", function (e) {\n  if (document.body.getAttribute(\"data-mounted\")) {\n    return;\n  }\n\n  var trigger = inside(e.target, \"[data-trigger-name]\");\n\n  if (trigger) {\n    e.preventDefault();\n    var name = trigger.getAttribute(\"data-trigger-name\");\n    var q = JSON.parse(JSON.stringify(query));\n    q[name + \"-enabled\"] = q[name + \"-enabled\"] === \"true\" ? \"false\" : \"true\";\n    window.location.search = \"?\" + stringifyQuery(q);\n    return;\n  }\n\n  var link = inside(e.target, \"a\");\n\n  if (link) {\n    var href = link.getAttribute(\"href\");\n\n    if (href.charAt(0) === \".\" || href.charAt(0) === \"/\") {\n      var lq = parseQueryString(link.search);\n      e.preventDefault();\n      window.location.href = link.pathname + \"?\" + stringifyQuery(merge(lq, query));\n    }\n  }\n});\n\nfunction matches(node, selector) {\n  if (typeof node.matches === \"function\") {\n    return node.matches(selector);\n  }\n\n  return node.msMatchesSelector(selector);\n}\n\nfunction merge(o, p) {\n  var r = {};\n  for (var attrname in o) { r[attrname] = o[attrname] }\n  for (var attrname in p) { r[attrname] = p[attrname] }\n  return r;\n}\n\nfunction supported() {\n  try {\n    eval(\"async () => {}\");\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\n\nfunction stringifyQuery(map) {\n  return Object.keys(map)\n    .map(function(key) {\n      return [key, map[key]].join(\"=\")\n    })\n    .join(\"&\");\n}\n\nfunction parseQueryString(search) {\n  search = search.charAt(0) === \"?\" ? search.slice(1) : search;\n  return search.split(\"&\")\n    .map(function(pair) {\n      return pair.split(\"=\");\n    })\n    .reduce(function(acc, entry) {\n      if (entry[1] === \"false\" ||Â entry[1] === \"true\") {\n        acc[entry[0]] = entry[1] ;\n      }\n      return acc;\n    }, {});\n}\n\nfunction inside(el, selector) {\n  while (el) {\n    if (el.nodeType === 1 && matches(el, selector)) {\n      return el;\n    }\n\n    el = el.parentNode;\n  }\n\n  return null;\n}\n"]}